<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="board">
    
    <select id="selectBoardList" resultType="board">
    	SELECT B.* , U.NICKNAME
    	FROM BOARD B
    	JOIN USERS U ON B.USER_ID = U.USER_ID
    	LEFT JOIN MBTI_BOARD MB ON B.BOARD_ID = MB.BOARD_ID
		<where>
			<if test="mbtiName != null and mbtiName != ''">
				MBTI_NAME = #{mbtiName}	
			</if>
		</where>
    </select>
    
    <select id="selectBoard" resultType="board">
    	SELECT B.* , U.NICKNAME
    	FROM BOARD B
    	JOIN USERS U ON B.USER_ID = U.USER_ID    	
    	WHERE BOARD_ID = #{boardId}
    </select>
    
    <insert id="insertBoard">
    	INSERT INTO BOARD(BOARD_ID, CATEGORY_ID, TITLE, CONTENT, USER_ID)
    	VALUES(BOARD_SEQ.NEXTVAL , #{categoryId}, #{title}, #{content}, 8)
    	
    	<selectKey keyProperty="boardId" resultType="int" order="AFTER">
    		SELECT BOARD_SEQ.CURRVAL FROM DUAL
    	</selectKey>
    </insert>
    
    <insert id="insertMbtiBoard">
    	INSERT INTO MBTI_BOARD
    	VALUES(#{boardId} , #{mbtiName})
    </insert>
    
    <update id="incrementView">
	    UPDATE BOARD
	    SET "VIEW" = "VIEW" + 1
	    WHERE BOARD_ID = #{boardId}
	</update>
    
    
    
</mapper>